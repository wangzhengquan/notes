<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://wangzhengquan.github.io/notes/math/Rodrigues%27%20rotation/Rodrigues%27%20rotation/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.3.9"><title>Rodrigues' rotation - 笔记</title><link rel=stylesheet href=../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=none data-md-color-accent=none> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#rodrigues-rotation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=笔记 class="md-header__button md-logo" aria-label=笔记 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 笔记 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Rodrigues' rotation </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=笔记 class="md-nav__button md-logo" aria-label=笔记 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> 笔记 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> 简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> OS (xv6) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS (xv6)" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> OS (xv6) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../xv6/ class=md-nav__link> xv6简介 </a> </li> <li class=md-nav__item> <a href=../../../xv6/boot_loader/ class=md-nav__link> Boot loader </a> </li> <li class=md-nav__item> <a href=../../../xv6/entry_%20kernel/ class=md-nav__link> Entry kernel </a> </li> <li class=md-nav__item> <a href=../../../xv6/scheduler/ class=md-nav__link> Scheduler </a> </li> <li class=md-nav__item> <a href=../../../xv6/the_first_process/ class=md-nav__link> 第一个进程 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6 type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6> 中断 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=中断 data-md-level=2> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> 中断 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../xv6/interrups_process/ class=md-nav__link> 中断处理流程 </a> </li> <li class=md-nav__item> <a href=../../../xv6/system_call/ class=md-nav__link> 系统调用 </a> </li> <li class=md-nav__item> <a href=../../../xv6/timer_interrupt/ class=md-nav__link> 时间中断 </a> </li> <li class=md-nav__item> <a href=../../../xv6/disk_interrupt/ class=md-nav__link> 硬盘中断 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../xv6/file_system/ class=md-nav__link> 文件系统 </a> </li> <li class=md-nav__item> <a href=../../../xv6/device/ class=md-nav__link> 设备管理 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Math <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Math data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Math </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Rodrigues' rotation <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Rodrigues' rotation </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> Table of Contents </a> </li> <li class=md-nav__item> <a href=#breaking-up-the-formula class=md-nav__link> Breaking up the formula </a> <nav class=md-nav aria-label="Breaking up the formula"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#geometric-proof class=md-nav__link> Geometric proof </a> </li> <li class=md-nav__item> <a href=#algebraic-proof class=md-nav__link> Algebraic proof </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rotating-around-a-circle class=md-nav__link> Rotating around a circle </a> </li> <li class=md-nav__item> <a href=#putting-it-all-together class=md-nav__link> Putting it all together </a> </li> <li class=md-nav__item> <a href=#matrix-form class=md-nav__link> Matrix form </a> </li> <li class=md-nav__item> <a href=#2d-rotation-matrix class=md-nav__link> 2D rotation matrix </a> </li> <li class=md-nav__item> <a href=#euler-angle-rotations class=md-nav__link> Euler angle rotations </a> <nav class=md-nav aria-label="Euler angle rotations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fromeuleranglesxyz class=md-nav__link> fromEulerAnglesXYZ </a> </li> <li class=md-nav__item> <a href=#fromeuleranglesyxz class=md-nav__link> fromEulerAnglesYXZ </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Quaternions/Quaternions/ class=md-nav__link> Quaternions </a> </li> <li class=md-nav__item> <a href=../../Windowing%20transformations/ class=md-nav__link> Windowing transformations </a> </li> <li class=md-nav__item> <a href=../../distance%20from%20point%20to%20plane/ class=md-nav__link> distance from point to plane </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> graphics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=graphics data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> graphics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../graphics/opengl/Data%20shared%20between%20CPU%20and%20GPU/ class=md-nav__link> Data shared between CPU and GPU </a> </li> <li class=md-nav__item> <a href=../../../graphics/opengl/Matrices%20in%20opengl/ class=md-nav__link> Matrices in opengl </a> </li> <li class=md-nav__item> <a href="../../../graphics/opengl/VBO/ Indexing.md" class=md-nav__link> VBO Indexing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> network <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=network data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> network </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network/tcp/ class=md-nav__link> TCP </a> </li> <li class=md-nav__item> <a href=../../../network/icmp/ class=md-nav__link> ICMP </a> </li> <li class=md-nav__item> <a href=../../../network/dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../../../network/dhcp/ class=md-nav__link> DHCP </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> database <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=database data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../database/sql/ class=md-nav__link> SQL </a> </li> <li class=md-nav__item> <a href=../../../database/B%2B%20Tree/B%2B%20Tree/ class=md-nav__link> B+ Tree </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> Table of Contents </a> </li> <li class=md-nav__item> <a href=#breaking-up-the-formula class=md-nav__link> Breaking up the formula </a> <nav class=md-nav aria-label="Breaking up the formula"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#geometric-proof class=md-nav__link> Geometric proof </a> </li> <li class=md-nav__item> <a href=#algebraic-proof class=md-nav__link> Algebraic proof </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rotating-around-a-circle class=md-nav__link> Rotating around a circle </a> </li> <li class=md-nav__item> <a href=#putting-it-all-together class=md-nav__link> Putting it all together </a> </li> <li class=md-nav__item> <a href=#matrix-form class=md-nav__link> Matrix form </a> </li> <li class=md-nav__item> <a href=#2d-rotation-matrix class=md-nav__link> 2D rotation matrix </a> </li> <li class=md-nav__item> <a href=#euler-angle-rotations class=md-nav__link> Euler angle rotations </a> <nav class=md-nav aria-label="Euler angle rotations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fromeuleranglesxyz class=md-nav__link> fromEulerAnglesXYZ </a> </li> <li class=md-nav__item> <a href=#fromeuleranglesyxz class=md-nav__link> fromEulerAnglesYXZ </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=rodrigues-rotation>Rodrigues' rotation</h1> <p>Having the ability to rotate vectors is a very useful tool to have in your repotoire. One of the easiest ways to do this is by using Rodrigues' rotation formula. In this article we are going to discuss how the formula is derived.</p> <h2 id=table-of-contents>Table of Contents</h2> <ul> <li><a href=#breaking-up-the-formula>Breaking up the formula</a><ul> <li><a href=#geometric-proof>Geometric proof</a></li> <li><a href=#algebraic-proof>Algebraic proof</a></li> </ul> </li> <li><a href=#rotating-around-a-circle>Rotating around a circle</a></li> <li><a href=#putting-it-all-together>Putting it all together</a></li> <li><a href=#matrix-form>Matrix form</a></li> <li><a href=#2d-rotation-matrix>2D rotation matrix</a></li> <li><a href=#euler-angle-rotations>Euler angle rotations</a><ul> <li><a href=#fromeuleranglesxyz>fromEulerAnglesXYZ</a></li> <li><a href=#fromeuleranglesyxz>fromEulerAnglesYXZ</a></li> </ul> </li> </ul> <h2 id=breaking-up-the-formula>Breaking up the formula</h2> <p>To start off let's look at what a Rodrigues' rotation actually looks like.</p> <p><img alt=img1 src=../imgs/img1.gif></p> <p>By drawing a few extra parts we can see the formula is rotating the red vector around the blue vector much like the axle of a car.</p> <p><img alt=img2 src=../imgs/img2.gif></p> <p>We can start by labeling the parts we just drew and then finding their values.</p> <p><img alt=img3 src=../imgs/img3.png> <img alt=eq1 src=../imgs/eq1.png></p> <p>In order to properly rotate we'll need two perpendicular vectors that trace the edge of the circle. We already have one of these in the form of <code>r</code>. To get the second one we will cross <code>k</code> and <code>v</code> to give us <code>r*</code>.</p> <p><img alt=img4 src=../imgs/img4.png></p> <p>You might be thinking that crossing <code>k</code> and <code>v</code> seems like an odd choice, after all we're trying to find a perpendicular vector with the same magnitude as <code>r</code>. To show that the magnitude of <code>r*</code> is the same as the magnitude of <code>r</code> we will compare to a more obvious cross product choice that we know would have the correct magnitude.</p> <p>Claim: <img alt=eq2 src=../imgs/eq2.png></p> <h3 id=geometric-proof>Geometric proof</h3> <p>If we look at a side view of our vectors and use basic trigonic intuition (SOHCAHTOA) we can see the angle between <code>k</code> and <code>v</code> scales the cross product magnitude to the same as <code>k x r</code>.</p> <p><img alt=eq3 src=../imgs/eq3.png> <img alt=img5 src=../imgs/img5.png></p> <h3 id=algebraic-proof>Algebraic proof</h3> <p>Alternatively we can plug the values in and simplify:</p> <p><img alt=eq5 src=../imgs/eq5.png></p> <h2 id=rotating-around-a-circle>Rotating around a circle</h2> <p>Now that we have two perpendicular vectors we can talk about how to use them to rotate around a circle. </p> <p>Since <code>cosθ</code> and <code>sinθ</code> can be thought of as x and y components on a unit circle we can use them to scale the two perpendicular axes to find a point on the edge of the circle.</p> <p><img alt=img6 src=../imgs/img6.gif></p> <p>Thus, to represent this new vector, <code>r'</code>, we can use the following equation:</p> <p><img alt=eq6 src=../imgs/eq6.png></p> <h2 id=putting-it-all-together>Putting it all together</h2> <p>Finally, to get the end result we must add the <code>r'</code> vector to the <code>d</code> vector to give us our rotated <code>v</code> vector.</p> <p><img alt=eq7 src=../imgs/eq7.png></p> <p>This leaves us with the final equation and what you would find <a href=https://en.wikipedia.org/wiki/Rodrigues%27_rotation_formula>on wikipedia</a>!</p> <pre><code class=language-Lua>local function rodriguesRotation(v, k, t)
    k = k.unit;
    local cos, sin = math.cos(t), math.sin(t);
    return v*cos + (1-cos)*v:Dot(k)*k + k:Cross(v)*sin;
end
</code></pre> <h2 id=matrix-form>Matrix form</h2> <p>In the previous section we had a equation that gave us a rotated vector. Occasionally we may find it useful to be able to preform this same rotation opperation, but with a matrix instead.</p> <p>To start off we must realize that we need a way to represent the dot product and the cross product as matrix multiplications.</p> <p><img alt=eq8 src=../imgs/eq8.png></p> <p><img alt=eq9 src=../imgs/eq9.png></p> <p>Now we can plug these into the original equation and factor out the vector we want to rotate, <code>v</code>. We'll note that we get a clear distinction between the rotation matrix <code>R</code> and <code>v</code>.</p> <p><img alt=eq10 src=../imgs/eq10.png></p> <p>Next we can show that:</p> <p><img alt=eq11 src=../imgs/eq11.png> <img alt=eq12 src=../imgs/eq12.png></p> <p>Remembering that since <code>k</code> is a unit vector it must be true that $kx^2 + ky^2 + kz^2 = 1$ which can then be rearranged and used to simplify.</p> <p><img alt=eq13 src=../imgs/eq13.png></p> <p>Using this revelation we can rewrite our <code>R</code> matrix.</p> <p><img alt=eq14 src=../imgs/eq14.png></p> <p>Now expand it:</p> <p><img alt=eq15 src=../imgs/eq15.png></p> <p>Again using the knowledge that $kx^2 + ky^2 + kz^2 = 1$ we can simplify which leaves us with the final form of the matrix.</p> <p><img alt=eq16 src=../imgs/eq16.png></p> <p>This rotation matrix is equivalent to the <code>CFrame.fromAxisAngle</code> constructor.</p> <pre><code class=language-Lua>local function rodriguesMatrix(k, t)
    -- we will use CFrame for this
    local kx, ky, kz = k.x, k.y, k.z
    local cos, sin = math.cos(t), math.sin(t);
    return CFrame.new(0, 0, 0,
        cos + (1-cos)*kx*kx, -sin*kz + (1-cos)*kx*ky, sin*ky + (1-cos)*kx*kz,
        sin*kz + (1-cos)*ky*kx, cos + (1-cos)*ky*ky, -sin*kx + (1-cos)*ky*kz,
        -sin*ky + (1-cos)*kz*kx, sin*kx + (1-cos)*kz*ky, cos + (1-cos)*kz*kz
    );
end

-- now we can re-use the same rotation:
local R = rodriguesMatrix(Vector3.new(0, 0, 1), math.pi/2); -- 90 degrees counter-clockwise around z-axis
print(R * Vector3.new(1, 0, 0)); -- 0, 1, 0
print(R * Vector3.new(0, 1, 0)); -- -1, 0, 0
</code></pre> <h2 id=2d-rotation-matrix>2D rotation matrix</h2> <p>There are a number of ways to find the 2D rotation matrix, but since we have already done all the math for the matrix form we may as well use it to find out how to rotate a 2D vector.</p> <p>We know that since we're only rotating x and y components the axis of rotation is <code>k = (0, 0, 1)</code>. If we plug that into the matrix and simplify we're left with the following matrix:</p> <p><img alt=eq17 src=../imgs/eq17.png></p> <p>Of course all we need from this matrix to rotate a 2D vector is the square top left corner. This leaves us with our 2D rotation matrix.</p> <p><img alt=eq18 src=../imgs/eq18.png></p> <pre><code class=language-Lua>local function rotateV2(v, t)
    local cos, sin = math.cos(t), math.sin(t);
    local x = v.x*cos - v.y*sin;
    local y = v.x*sin + v.y*cos;
    return Vector2.new(x, y);
end
</code></pre> <h2 id=euler-angle-rotations>Euler angle rotations</h2> <p>We can also use the matrix form of a Rodrigues' rotation to find out how euler angle rotations work. In the same way that we focused on rotation around the z-axis in the 2D rotation matrix section we can also write out the matrices that represent the x and y axes as well.</p> <p><img alt=eq19 src=../imgs/eq19.png></p> <h3 id=fromeuleranglesxyz>fromEulerAnglesXYZ</h3> <p>Multiplying the above matrices as <code>Rx * Ry * Rz</code> we get a rotation matrix that represents a rotation applied in Z, Y, X order (this is due to vectors post multiplying).</p> <p><img alt=eq20 src=../imgs/eq20.png></p> <p>This matrix is exactly what the <code>CFrame.fromEulerAnglesXYZ</code> and <code>CFrame.Angles</code> constructors use.</p> <pre><code class=language-Lua>local function fromEulerAnglesXYZ(rx, ry, rz)
    local cx, sx = math.cos(rx), math.sin(rx);
    local cy, sy = math.cos(ry), math.sin(ry);
    local cz, sz = math.cos(rz), math.sin(rz);

    return CFrame.new(0, 0, 0,
        cy*cz, -cy*sz, sy,
        sx*sy*cz+cx*sz, -sx*sy*sz+cx*cz, -sx*cy,
        -cx*sy*cz+sx*sz, cx*sy*sz+sx*cz, cx*cy
    );
end

local function toEulerAnglesXYZ(cf)
    local x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33 = cf:components();
    local rx = math.atan2(-m23, m33)
    local ry = math.asin(m13);
    local rz = math.atan2(-m12, m11);
    return rx, ry, rz;
end
</code></pre> <h3 id=fromeuleranglesyxz>fromEulerAnglesYXZ</h3> <p>Multiplying the above matrices as <code>Ry * Rx * Rz</code> we get a rotation matrix that represents a rotation applied in Z, X, Y order (this is due to vectors post multiplying).</p> <p><img alt=eq21 src=../imgs/eq21.png></p> <p>This matrix is exactly what the <code>CFrame.fromEulerAnglesYXZ</code> and <code>CFrame.fromOrientation</code> constructors use.</p> <pre><code class=language-Lua>local function fromEulerAnglesYXZ(rx, ry, rz)
    local cx, sx = math.cos(rx), math.sin(rx);
    local cy, sy = math.cos(ry), math.sin(ry);
    local cz, sz = math.cos(rz), math.sin(rz);

    return CFrame.new(0, 0, 0,
        cy*cz+sy*sx*sz, -cy*sz+sy*sx*cz, sy*cx,
        cx*sz, cx*cz, -sx,
        -sy*cz+cy*sx*sz, sy*sz+cy*sx*cz, cy*cx
    );
end

local function toEulerAnglesYXZ(cf)
    local x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33 = cf:components();
    local rx = math.asin(-m23)
    local ry = math.atan2(m13, m33)
    local rz = math.atan2(m21, m22);
    return rx, ry, rz;
end
</code></pre> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../../xv6/device/ class="md-footer__link md-footer__link--prev" aria-label="Previous: 设备管理" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> 设备管理 </div> </div> </a> <a href=../../Quaternions/Quaternions/ class="md-footer__link md-footer__link--next" aria-label="Next: Quaternions" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Quaternions </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.6c7ad80a.min.js></script> </body> </html>