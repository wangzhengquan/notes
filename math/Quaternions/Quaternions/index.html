<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://wangzhengquan.github.io/notes/math/Quaternions/Quaternions/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.3.9"><title>Quaternions - 笔记</title><link rel=stylesheet href=../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=none data-md-color-accent=none> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#crash-course-on-imaginarycomplex-numbers class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=笔记 class="md-header__button md-logo" aria-label=笔记 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 笔记 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Quaternions </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=笔记 class="md-nav__button md-logo" aria-label=笔记 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> 笔记 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> 简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> OS (xv6) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS (xv6)" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> OS (xv6) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../xv6/ class=md-nav__link> xv6简介 </a> </li> <li class=md-nav__item> <a href=../../../xv6/boot_loader/ class=md-nav__link> Boot loader </a> </li> <li class=md-nav__item> <a href=../../../xv6/entry_%20kernel/ class=md-nav__link> Entry kernel </a> </li> <li class=md-nav__item> <a href=../../../xv6/scheduler/ class=md-nav__link> Scheduler </a> </li> <li class=md-nav__item> <a href=../../../xv6/the_first_process/ class=md-nav__link> 第一个进程 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6 type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6> 中断 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=中断 data-md-level=2> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> 中断 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../xv6/interrups_process/ class=md-nav__link> 中断处理流程 </a> </li> <li class=md-nav__item> <a href=../../../xv6/system_call/ class=md-nav__link> 系统调用 </a> </li> <li class=md-nav__item> <a href=../../../xv6/timer_interrupt/ class=md-nav__link> 时间中断 </a> </li> <li class=md-nav__item> <a href=../../../xv6/disk_interrupt/ class=md-nav__link> 硬盘中断 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../xv6/file_system/ class=md-nav__link> 文件系统 </a> </li> <li class=md-nav__item> <a href=../../../xv6/device/ class=md-nav__link> 设备管理 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Math <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Math data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Math </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Rodrigues%27%20rotation/Rodrigues%27%20rotation/ class=md-nav__link> Rodrigues' rotation </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Quaternions <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Quaternions </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#crash-course-on-imaginarycomplex-numbers class=md-nav__link> Crash course on imaginary/complex numbers </a> </li> <li class=md-nav__item> <a href=#the-quaternion-is-born class=md-nav__link> The quaternion is born </a> </li> <li class=md-nav__item> <a href=#quaternion-operations-add-multiplication class=md-nav__link> Quaternion Operations (Add &amp; Multiplication) </a> </li> <li class=md-nav__item> <a href=#definitions class=md-nav__link> Definitions </a> <nav class=md-nav aria-label=Definitions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quaternion-conjugate-and-inverse class=md-nav__link> Quaternion Conjugate and Inverse </a> </li> <li class=md-nav__item> <a href=#representing-a-3d-vector class=md-nav__link> Representing a 3D Vector </a> </li> <li class=md-nav__item> <a href=#the-unit-rotation-quaternion class=md-nav__link> The Unit Rotation Quaternion </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prove-the-validity-of-quaternions class=md-nav__link> Prove the validity of Quaternions </a> <nav class=md-nav aria-label="Prove the validity of Quaternions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#expanding-the-quaternion-product class=md-nav__link> Expanding the Quaternion Product </a> <nav class=md-nav aria-label="Expanding the Quaternion Product"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#part-a-calculate-q-p class=md-nav__link> Part A: Calculate $q p$ </a> </li> <li class=md-nav__item> <a href=#part-b-calculate-q-p-barq class=md-nav__link> Part B: Calculate $(q p) \bar{q}$ </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Windowing%20transformations/ class=md-nav__link> Windowing transformations </a> </li> <li class=md-nav__item> <a href=../../distance%20from%20point%20to%20plane/ class=md-nav__link> distance from point to plane </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> graphics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=graphics data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> graphics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../graphics/opengl/Data%20shared%20between%20CPU%20and%20GPU/ class=md-nav__link> Data shared between CPU and GPU </a> </li> <li class=md-nav__item> <a href=../../../graphics/opengl/Matrices%20in%20opengl/ class=md-nav__link> Matrices in opengl </a> </li> <li class=md-nav__item> <a href="../../../graphics/opengl/VBO/ Indexing.md" class=md-nav__link> VBO Indexing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> network <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=network data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> network </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network/tcp/ class=md-nav__link> TCP </a> </li> <li class=md-nav__item> <a href=../../../network/icmp/ class=md-nav__link> ICMP </a> </li> <li class=md-nav__item> <a href=../../../network/dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../../../network/dhcp/ class=md-nav__link> DHCP </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> database <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=database data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../database/sql/ class=md-nav__link> SQL </a> </li> <li class=md-nav__item> <a href=../../../database/B%2B%20Tree/B%2B%20Tree/ class=md-nav__link> B+ Tree </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#crash-course-on-imaginarycomplex-numbers class=md-nav__link> Crash course on imaginary/complex numbers </a> </li> <li class=md-nav__item> <a href=#the-quaternion-is-born class=md-nav__link> The quaternion is born </a> </li> <li class=md-nav__item> <a href=#quaternion-operations-add-multiplication class=md-nav__link> Quaternion Operations (Add &amp; Multiplication) </a> </li> <li class=md-nav__item> <a href=#definitions class=md-nav__link> Definitions </a> <nav class=md-nav aria-label=Definitions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quaternion-conjugate-and-inverse class=md-nav__link> Quaternion Conjugate and Inverse </a> </li> <li class=md-nav__item> <a href=#representing-a-3d-vector class=md-nav__link> Representing a 3D Vector </a> </li> <li class=md-nav__item> <a href=#the-unit-rotation-quaternion class=md-nav__link> The Unit Rotation Quaternion </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prove-the-validity-of-quaternions class=md-nav__link> Prove the validity of Quaternions </a> <nav class=md-nav aria-label="Prove the validity of Quaternions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#expanding-the-quaternion-product class=md-nav__link> Expanding the Quaternion Product </a> <nav class=md-nav aria-label="Expanding the Quaternion Product"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#part-a-calculate-q-p class=md-nav__link> Part A: Calculate $q p$ </a> </li> <li class=md-nav__item> <a href=#part-b-calculate-q-p-barq class=md-nav__link> Part B: Calculate $(q p) \bar{q}$ </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Quaternions</h1> <p>Readers are recommended to have read the <a href=../../Rodrigues%27%20rotation/Rodrigues%27%20rotation/ >Rodrigues' rotation</a> article ahead of time as it will be used to compare results.</p> <h2 id=crash-course-on-imaginarycomplex-numbers>Crash course on imaginary/complex numbers</h2> <p>Before we can get into understanding quaternions we first need to understand the concept of imaginary and complex numbers. The names might seem daunting, but for our purposes the concepts are pretty straight forward. </p> <p>Imaginary numbers have a very simple purpose, to solve equations that real numbers couldn’t! For example: $$x^2 + 25 = 0$$ There is no real number solution to this equation because any real number we take to the power of two will result in a positive number. So in order for the above equation to be true it must be that: $$x^2 = -25$$ This is what we call an imaginary number. They are special in the sense that they square to a real negative value. So far we have used $x$ as a variable, but usually when representing imaginary numbers we use what is called the imaginary unit <code>i</code> where $i^2 = -1$. That way we can represent any imaginary number as a product of a real number and <code>i</code>. For example: $$(5<em>i)^2 + 25 = 25</em>(i^2) + 25 = -25 + 25 = 0$$ You might notice that the imaginary unit has a pattern when taken to different powers:</p> <table> <thead> <tr> <th>Power Pattern</th> </tr> </thead> <tbody> <tr> <td>$i^0 = 1$</td> </tr> <tr> <td>$i^1 = i$</td> </tr> <tr> <td>$i^2 = -1$</td> </tr> <tr> <td>$i^3 = -i$</td> </tr> <tr> <td>$i^4 = 1$</td> </tr> <tr> <td>$i^5 = i$</td> </tr> <tr> <td>$i^6 = -1$</td> </tr> <tr> <td>$i^7 = -i$</td> </tr> <tr> <td>...</td> </tr> </tbody> </table> <p>You'll note that this pattern also holds true for negative powers. Simply take notice that $i^{-1} = (1/i) * (i/i) = i/i^2 = i/-1 = -i$ and the rest of the negative powers become trivial to calculate.</p> <p>This pattern of <code>1, i, -1, -i</code> may feel familiar to you. If we treat the real number part of the pattern as being on the x-axis and the imaginary parts as being on the y-axis then the pattern is essentially the same as <code>x , y, -x, -y</code> which is rotating 90 degrees counter-clockwise.</p> <p><img alt=img1 src=../imgs/technical/img1.png></p> <p><img alt=img2 src=../imgs/technical/img2.png></p> <p>Since these patterns share so much in common we can use a combination of imaginary and real numbers to represent numbers on a two dimensional grid. We call these complex numbers and we place them on the complex plane.</p> <p><img alt=img3 src=../imgs/technical/img3.png></p> <p>Interestingly, if we multiply a complex number by <code>i</code> we're left with a resulting complex number that has been rotated 90 degrees counter-clockwise.</p> <p>$$ \begin{align} &amp; (2 + i) \ &amp; (2 + i)<em>i = 2</em>i + i^2 = -1 + 2<em>i \ &amp; (2 + i)</em>i^2 = (-1 + 2<em>i)</em>i = -i + 2<em>i^2 = -2 - i \ &amp; (2 + i)</em>i^3 = (-2 - i)<em>i = -2</em>i - i^2 = 1 - 2<em>i \ &amp; (2 + i)</em>i^4 = (1 - 2<em>i)</em>i = i - 2*i^2 = 2 + i \ \end{align} $$</p> <p><img alt=img4 src=../imgs/technical/img4.png></p> <p>We can expand on this concept by instead multiplying with a complex number that gives us control of the angle we rotate by.</p> <p>We can trace a unit circle with $cosθ + sinθ*i$ so if we multiply it by a complex number we get a general formula for rotating counter-clockwise by any angle, we call this a rotor.</p> <p>$$ \begin{align} (w + xi)<em>(cosθ + sinθ</em>i) &amp; = w<em>cosθ + w</em>sinθ<em>i + x</em>cosθ<em>i + x</em>sinθ<em>i^2 \ &amp; = w</em>cosθ - x<em>sinθ + (w</em>sinθ + x*cosθ)i \ \end{align} $$</p> <p>You might be somewhat familiar with this formula. It's just the 2D rotation matrix in complex number form!</p> <h2 id=the-quaternion-is-born>The quaternion is born</h2> <p>Prior to quaternions most people saw the complex plane in 2D and simply figured if they wanted to add a third dimension they just had to add another imaginary number, say $j^2 = -1$. Quickly however they found this didn't quite work due to multiplication requiring us to know the product of two imaginary numbers.</p> <p>$$ \begin{flalign<em>} (w_1 + x_1 i + y_1 j)(w_2 + x_2 i + y_2 j) &amp;= w_1 w_2 + w_1 x_2 i + w_1 y_2 j &amp;\ &amp; \quad + x_1 w_2 i + x_1 x_2 i^2 + x_1 y_2 ij \ &amp; \quad + y_1 w_2 j + y_1 x_2 ji + y_1 y_2 j^2 \ &amp;= w_1 w_2 - x_1 x_2 - y_1 y_2 \ &amp; \quad + (w_1 x_2 + x_1 w_2)i \ &amp; \quad + (w_1 y_2 + y_1 w_2)j \ &amp; \quad + x_1 y_2 ij + y_1 x_2 ji \end{flalign</em>} $$</p> <blockquote> <p>Note: $ij$ and $ji$ are not commutative due to their imaginary nature. </p> </blockquote> <p>For quite sometime this problem didn't see much attention until an Irish mathematician named William Rowan Hamilton who figured the best way to solve it was to add a third imaginary number. </p> <p>Famously the condition he wrote was:</p> <p>$$ i^2 = j^2 = k^2 = i<em>j</em>k = -1 $$</p> <p>This may seem a bit confusing, but it we separate this out (and again respect the non-commutativity) we get a few equalities we can use to expand.</p> <pre><code>i^2 = -1    j^2 = -1    k^2 = -1
i*j = k     j*k = i     k*i = j
j*i = -k    k*j = -i    i*k = -j
</code></pre> <p>In short Hamilton said that instead of stumping ourselves by not knowing a real number that is the resulting product of two imaginary numbers just set its product to another imaginary number and from there we can figure stuff out.</p> <h2 id=quaternion-operations-add-multiplication>Quaternion Operations (Add &amp; Multiplication)</h2> <p>We have quaternions in the following form:</p> <p>$$ q = w + xi + yj + zk $$</p> <p>We can store that same information as an ordered pair by splitting up the real number part from the imaginary part. Thus the above becomes:</p> <p>$$ q = [w, xi + yj + zk] $$</p> <p>If we treat <code>i</code>, <code>j</code>, and <code>k</code> as separate axes then we can store the second element of the ordered pair as a 3 dimensional vector, We can also write q as:</p> <p>$$ \begin{align} &amp; q = [w, \vec{v}] \end{align} $$</p> <p>where $w$ is the scalar part and $\vec{v} = (x, y, z)$ is the vector part.</p> <p>Let $$q_1 = [w_1, \vec{v_1}] \qquad q_2 = [w_2, \vec{v_2}]$$</p> <p>If we wanted to add or subtract two quaternions its quite straight forward. We just add/subtract each individual component.</p> <p>$$ \begin{align} &amp; q_1 + q_2 = [w_1 + w_2, \vec{v_1} + \vec{v_2}] \ &amp; q_1 - q_2 = [w_1 - w_2, \vec{v_1} - \vec{v_2}] \ \end{align} $$</p> <p>Multiplication is not quite as simple as addition and subtraction. We can figure out how to do this calculation by applying the equalities Hamilton's equation.</p> <p>$$ \begin{flalign<em>} q_1 * q_2 &amp;=[w₁, \vec{v₁}]</em>[w₂, \vec{v₂}] &amp;\ &amp;= (w_1 + x_1i + y_1j + z_1k)(w_2 + x_2i + y_2j + z_2k) &amp; \ &amp; \text{Expanding​ using the distributive property} \ &amp;= w_1w_2 + w_1(x_2i + y_2j + z_2k) \ &amp; \quad + x_1w_2i + x_1x_2i^2 + x_1y_2ij + x_1z_2ik \ &amp; \quad + y_1w_2j + y_1x_2ji + y_1y_2j^2 + y_1z_2jk \ &amp; \quad + z_1w_2k + z_1x_2ki + z_1y_2kj + z_1z_2k^2 \ &amp;= w_1w_2 - x_1x_2 - y_1y_2 - z_1z_2 \ &amp; \quad + w_1(x_2i + y_2j + z_2k) + w_2(x_1i + y_1j + z_1k) \ &amp; \quad + x_1y_2k - x_1z_2j - y_1x_2k + y_1z_2i + z_1x_2j - z_1y_2i \ &amp;=[w₁w₂ - \vec{v₁}·\vec{v₂}, \; w₁\vec{v₂} + w₂\vec{v₁} + \vec{v₁}×\vec{v₂}] \end{flalign*} $$</p> <h2 id=definitions>Definitions</h2> <h3 id=quaternion-conjugate-and-inverse>Quaternion Conjugate and Inverse</h3> <ul> <li>The <strong>conjugate</strong> of $q = [w, \vec{v}]$ is $\bar{q} = [w, -\vec{v}]$.</li> <li>The <strong>norm</strong> (magnitude squared) is $||q||² = ||q \bar{q}|| = w² + x² + y² + z²$.</li> <li>The <strong>inverse</strong> is $q⁻¹ = \bar{q} / ||q||²$.</li> </ul> <p>We can use Multiplication form of the equation to find :</p> <p>$$ \begin{flalign<em>} q * \bar{q} &amp;= [w² + (\vec{v} . \vec{v}), \, w\vec{v} - w\vec{v} + (\vec{v} \times \vec{v})] &amp; \ &amp;= [w² + (\vec{v} . \vec{v}), \, (0, 0, 0)] &amp; \ &amp;= [w² + x² + y² + z², \, (0, 0, 0)] \end{flalign</em>} $$</p> <p>$$ \begin{flalign<em>} q * q^{-1} &amp;= (q * \bar{q}) / ||q||² &amp; \ &amp;= [1, (0, 0, 0)] \end{flalign</em>} $$ </p> <h3 id=representing-a-3d-vector>Representing a 3D Vector</h3> <p>A 3D vector $\vec{p} = (p_x, p_y, p_z)$ is represented as a <strong>pure quaternion</strong>, which is a quaternion with a zero scalar part:<br> $$p = 0 + p_xi + p_yj + p_zk = [0, \vec{p}]$$</p> <h3 id=the-unit-rotation-quaternion>The Unit Rotation Quaternion</h3> <p>For a rotation by angle θ around a <strong>unit vector</strong> axis $\vec{u} = (u_x, u_y, u_z)$, the corresponding <strong>unit quaternion</strong> (||q|| = 1) is:<br> $$q = [cos(θ/2), sin(θ/2) \vec{u}] $$ Since ||q|| = 1, its inverse is simply its conjugate: $q⁻¹ = \bar{q}$ </p> <h2 id=prove-the-validity-of-quaternions>Prove the validity of Quaternions</h2> <p>Assume $\vec{u}$ is a unit vector. Let $q = [w, \vec{v}]$, where w = cos(θ/2) , $\vec{v} = sin(θ/2) * \vec{u}$ .<br> Let $p = [0, \vec{p}]$.</p> <p>The <strong>Rodrigues' Rotation Formula</strong> $$\vec{p_{rot}} = \vec{p}cosθ + (\vec{u} \times \vec{p})sinθ + \vec{u}(\vec{u} ⋅ \vec{p})(1 - cosθ)$$ gives the result $\vec{p_{rot}}$ of rotating a vector $\vec{p}$ around a unit vector axis $\vec{u}$ by an angle θ.</p> <p>The <strong>Quaternion Formula</strong> is: $$p' = q p \bar{q}$$ If we can show that the vector part of $p'$ equals $\vec{p_{rot}}$, we have proven the validity of quaternion rotation.</p> <h3 id=expanding-the-quaternion-product>Expanding the Quaternion Product</h3> <h4 id=part-a-calculate-q-p>Part A: Calculate $q p$</h4> <p>Using the general quaternion multiplication rule $$[w₁, \vec{v₁}][w₂, \vec{v₂}] = [w₁<em>w₂ - \vec{v₁}·\vec{v₂}, w₁</em>\vec{v₂} + w₂<em>\vec{v₁} + \vec{v₁}×\vec{v₂}]$$we get:<br> $$ \begin{align} q p &amp; = [w, \vec{v}] * [0, \vec{p}] \ &amp; = [w</em>0 - \vec{v} ⋅ \vec{p}, \; w<em>\vec{p} + 0</em> \vec{v} + \vec{v} \times \vec{p}] \ &amp; = [-\vec{v} ⋅ \vec{p}, \; w\vec{p} + \vec{v} × \vec{p}] \end{align} $$</p> <h4 id=part-b-calculate-q-p-barq>Part B: Calculate $(q p) \bar{q}$</h4> <p>Now we multiply the result from Part A by $\bar{q} = [w, -\vec{v}]$.<br> Let $q p = [w', \vec{v'}]$ where $w' = -\vec{v} ⋅ \vec{p}$ and $\vec{v'} = w\vec{p} + \vec{v} × \vec{p}$. $$ \begin{align} p' &amp;= [w', \, \vec{v'}] [w, \, -\vec{v}] \ &amp;= [w'w - \vec{v'} ⋅ -\vec{v}), \, w'\vec{v} + w\vec{v'} + \vec{v'} \times -\vec{v}] \ &amp;= [w'w + \vec{v'} ⋅ \vec{v}, \, -w'\vec{v} + w\vec{v'} - \vec{v'} \times\vec{v}] \end{align} $$</p> <p>The final result $p'$ should be a pure quaternion (representing the rotated vector). Let's prove its scalar part is zero.<br> $$ \begin{align} Scalar \, part &amp;=w'w + \vec{v'} ⋅ \vec{v} \ &amp;= (-\vec{v} ⋅ \vec{p})w + (w\vec{p} + \vec{v} × \vec{p}) ⋅ \vec{v} \hspace{1cm} \text{ Substitute w' and v' } \ &amp;= -w(\vec{v} ⋅ \vec{p}) + w(\vec{p} ⋅ \vec{v}) + (\vec{v} × \vec{p}) ⋅ \vec{v}<br> \end{align} $$ The term$(\vec{v} × \vec{p}) ⋅ \vec{v}$ is the dot product of a vector with the result of a cross product involving that same vector. The result of $\vec{v} × \vec{p}$ is a vector orthogonal to $\vec{v}$. The dot product of two orthogonal vectors is zero.<br> So, $Scalar \, part= -w(\vec{v} ⋅ \vec{p}) + w(\vec{p} ⋅ \vec{v}) + 0 = 0$.<br> <strong>This confirms p' is a pure quaternion, as required.</strong></p> <p>Now for the complex part. The vector part is: $-w'\vec{v} + w\vec{v'} - \vec{v'} \times\vec{v}$.<br> Substitute w', $\vec{v'}$, w, and $\vec{v}$:</p> <ol> <li>$-w'\vec{v} = -(-\vec{v} ⋅ \vec{p}) \vec{v} = (\vec{v} ⋅ \vec{p}) \vec{v}$</li> <li>$w\vec{v'} = w(w\vec{p} + \vec{v} × \vec{p}) = w²\vec{p} + w(\vec{v} × \vec{p})$</li> <li>$- \vec{v'} × \vec{v} = -(w\vec{p} + \vec{v} × \vec{p}) × \vec{v} = -(w(\vec{p} × \vec{v}) + (\vec{v} × \vec{p}) × \vec{v})$ Using the vector triple product identity $(\vec{a} × \vec{b}) × \vec{c} = (\vec{a} ⋅ \vec{c})\vec{b} - (\vec{b} ⋅ \vec{c})\vec{a}$: $(\vec{v} × \vec{p}) × \vec{v} = (\vec{v} ⋅ \vec{v}) \vec{p} - (\vec{p} ⋅ \vec{v}) \vec{v} = ||\vec{v}||²\vec{p} - (\vec{p} ⋅ \vec{v}) \vec{v}$ So, $-(\vec{v'} × \vec{v}) = -w(\vec{p} × \vec{v}) - ||\vec{v}||²\vec{p} + (\vec{p} ⋅ \vec{v}) \vec{v}$ Since $\vec{p} × \vec{v} = - \vec{v} × \vec{p}$, this becomes $w(\vec{v} × \vec{p}) - ||\vec{v}||²\vec{p} + (\vec{p} ⋅ \vec{v}) \vec{v}$</li> </ol> <p>Now, let's add the three parts together:<br> $$ \begin{align} p'_{vec} = &amp; (\vec{v} ⋅ \vec{p})\vec{v} \qquad (from 1) \ &amp; + w²\vec{p} + w(\vec{v} × \vec{p}) \qquad (from 2) \ &amp; + w(\vec{v} × \vec{p}) - ||\vec{v}||²\vec{p} + (\vec{p} ⋅ \vec{v}) \vec{v} \qquad (from 3) \end{align} $$</p> <p>Combine like terms:<br> $$p'_{vec} = (w² - ||\vec{v}||²) \vec{p} + 2w(\vec{v} × \vec{p}) + 2(\vec{v} ⋅ \vec{p}) \vec{v}$$</p> <p>Finally, substitute $w = cos(θ/2)$ and $\vec{v} = sin(θ/2)\vec{u}$:</p> <ul> <li>$w² - ||\vec{v}||² = cos²(θ/2) - sin²(θ/2)||\vec{u}||² = cos²(θ/2) - sin²(θ/2) = cosθ$ (Double angle identity)</li> <li>$2w(\vec{v} × \vec{p}) = 2cos(θ/2)(sin(θ/2)\vec{u} × \vec{p}) = 2cos(θ/2)sin(θ/2)(\vec{u} × \vec{p}) = sinθ(\vec{u} × \vec{p})$ (Double angle identity)</li> <li>$2(\vec{v} ⋅ \vec{p}) \vec{v} = 2(sin(θ/2)\vec{u} ⋅ \vec{p}) (sin(θ/2)\vec{u}) = 2sin²(θ/2)(\vec{u} ⋅ \vec{p}) \vec{u} = (1 - cosθ)(\vec{u} ⋅ \vec{p}) \vec{u}$ (half-angle identity $2sin²(θ/2) = 1 - cosθ$)</li> </ul> <p>Substitute these back into the expression for $p'<em>{vec}$:<br> $$p'</em>{vec} = cosθ\vec{p} + sinθ(\vec{u} × \vec{p}) + (1 - cosθ)(\vec{u} ⋅ \vec{p}) \vec{u}$$ Rearranging to match the standard form of Rodrigues' formula:<br> $$p'_{vec} = \vec{p}cosθ + (\vec{u} × \vec{p})sinθ + \vec{u}(\vec{u} ⋅ \vec{p})(1 - cosθ)$$</p> <p><strong>This is identical to Rodrigues' Rotation Formula.</strong> We have mathematically proven that the quaternion operation $p' = q p \bar{q}$ produces a new pure quaternion $p'$ whose vector part is precisely the result of rotating the original vector $\vec{p}$ around the axis $\vec{u}$ by the angle θ.</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../Rodrigues%27%20rotation/Rodrigues%27%20rotation/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Rodrigues' rotation" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Rodrigues' rotation </div> </div> </a> <a href=../../Windowing%20transformations/ class="md-footer__link md-footer__link--next" aria-label="Next: Windowing transformations" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Windowing transformations </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.6c7ad80a.min.js></script> </body> </html>